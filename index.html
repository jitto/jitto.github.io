<html>
<head><title>Hello</title></head>
<body>
Enter list of words (one in each line) :
<br>
<textarea rows="30" cols="80" id="listOfWords">
  enter words here - one in each line
</textarea>
<br>
<button onclick="askWords()">Ask me these words</button>
<table>
  <tr><th>Correct words</th><th>Wrong words</th></tr>
  <tr>
    <td><textarea rows="14" cols="25" id="correct"></textarea></td>
    <td><textarea rows="14" cols="25" id="wrong"></textarea></td>
    <td><textarea rows="14" cols="25" id="typed"></textarea></td>
  </tr>
</table>
</div>
</body>
<script>
var greeting = new SpeechSynthesisUtterance("Hello There.    Enter the words and click Ask button")
greeting.lang = 'en-US';
greeting.rate = 0.8;
window.speechSynthesis.speak(greeting);

var listOfWords = document.getElementById("listOfWords");
var correct = document.getElementById("correct");
var wrong = document.getElementById("wrong");
var typed = document.getElementById("typed");

var initialList = localStorage.getItem('words');
if (initialList != null) {
  listOfWords.value = initialList;
}

function askWords() {
  localStorage.setItem('words', listOfWords.value);
  var allText = listOfWords.value.split("\n");
  listOfWords.style.backgroundColor = "black";
  correct.value = "";
  wrong.value = "";
  while (allText.length > 0) {
    var index = Math.floor((Math.random() * allText.length));
    var expectedValue = allText[index];
    allText.splice(index, 1);
    if (expectedValue.length > 0) {
      var answer = askWord(expectedValue);
      if (answer == null) {
        break;
      }
    }
  }
  listOfWords.style.backgroundColor = "white";
}

function askWord(expectedValue) {
  var msg = new SpeechSynthesisUtterance(expectedValue);
  msg.lang = 'en-US';
  msg.rate = 0.8;
  var response = "";
  while (response === "") {
    window.speechSynthesis.speak(msg);
    response = window.prompt("Type in spelling or press OK to repeat");
  }
  if (response != null) {
    if (response.toLowerCase() === expectedValue.toLowerCase()) {
      correct.value = expectedValue + "\n" + correct.value;
      wrong.style.backgroundColor = "white";
      correct.style.backgroundColor = "green";
    } else {
      wrong.value = expectedValue + "\n" + wrong.value;
      typed.value = response + "\n" + typed.value;
      wrong.style.backgroundColor = "red";
      correct.style.backgroundColor = "white";
    }
  }
  return response;
}
</script>
</html>
